(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{47:function(e,a,t){"use strict";t.r(a);var r=t(1),s=t.n(r),n=t(23),c=t.n(n),i=t(14),l=t(15),o=t(5);var m=()=>s.a.createElement("div",{className:"modal"},s.a.createElement("div",{className:"loadingAnimation"}));const u="https://davidyang2149.github.io/MyBakingRecipeVol2/static/css/",d=e=>!e,p=e=>a=>e.split(a)[0],g=e=>e.toDate().toISOString();var E=({userId:e,onSignIn:a,onSignOut:t})=>s.a.createElement("nav",{className:"header"},s.a.createElement("div",null,s.a.createElement(l.b,{to:"/"},s.a.createElement("img",{className:"homeImg",src:u+"assets/images/home.svg",alt:"Home"})),s.a.createElement(l.b,{to:"/"},s.a.createElement("h1",{className:"homeH1"},"My Baking Recipe"))),e?s.a.createElement("div",{className:"userInfo"},s.a.createElement("p",{className:"userName"},s.a.createElement(l.b,{to:"/"},p(e)("@"))),s.a.createElement("button",{className:"headerButton",type:"button"},"New Recipe"),s.a.createElement("button",{className:"headerButton",type:"button",onClick:t},"Logout"),s.a.createElement("img",{className:"userIcon",src:u+"assets/images/new-recipe.svg",alt:"New Recipe"}),s.a.createElement("img",{className:"userIcon",src:u+"assets/images/close-outline.svg",onClick:t,alt:"Logout"})):s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{className:"headerButton",type:"button",onClick:a},"Sign in (Google)"),s.a.createElement("img",{className:"userIcon",src:u+"assets/images/login-google.svg",onClick:a,alt:"singIn"}))),v=t(18),b=t(19);t(42),t(48),t(45);var I={apiKey:"AIzaSyBWq2ijQg3f9QqIx3gDKsYda0wIeed5zqE",authDomain:"mybakingrecipe.firebaseapp.com",databaseURL:"https://mybakingrecipe-default-rtdb.firebaseio.com",projectId:"mybakingrecipe",storageBucket:"mybakingrecipe.appspot.com",messagingSenderId:"915152243690",appId:"1:915152243690:web:eabd6afc6124e887434093",measurementId:"G-R8B8QCRYLB",status:"production"};b.a.initializeApp(I);const h=b.a.auth(),y=b.a.firestore,N=b.a.firestore(),w=new b.a.auth.GoogleAuthProvider,k=(b.a.storage(),(e,a)=>{sessionStorage.setItem(e,a)}),f={userId:"",displayName:""},{actions:R,reducer:B}=Object(v.b)({name:"user",initialState:f,reducers:{setUser:(e,{payload:{name:a,value:t}})=>({...e,[a]:t}),clearUser:e=>({...e,...f})}}),O=()=>async e=>{try{const{user:a}=await(async()=>await h.signInWithPopup(w))(),t=(null==a?void 0:a.email)||"";k("user",t),e(R.setUser({name:"userId",value:t}))}catch(e){throw new Error(e.message)}},S=()=>async e=>{var a;await(async()=>{await h.signOut()})(),a="user",sessionStorage.removeItem(a),e(R.clearUser())},j=()=>e=>{setTimeout(()=>{const a=h.currentUser,t=(null==a?void 0:a.email)||(r="user",sessionStorage.getItem(r))||"";var r;d(t)?e(R.clearUser()):(k("user",t),e(R.setUser({name:"userId",value:t})))},500)},{setUser:L,clearUser:U}=R;var F=B;var M=()=>{const e=Object(i.b)(),{user:{userId:a}}=Object(i.c)(e=>({user:e.user}));return s.a.createElement(E,{userId:a,onSignIn:()=>{e(O())},onSignOut:()=>{e(S())}})};var A=()=>s.a.createElement("div",{className:"theNotFoundModal"},s.a.createElement("img",{className:"theNotFoundImage",src:u+"assets/images/page-not-found.svg",alt:"recipe"}),s.a.createElement("p",{className:"theNotFoundTitle"},"해당 페이지를 찾을 수 없습니다."));var C=()=>s.a.createElement(A,null);var D=({root:e=null,target:a,onIntersect:t,threshold:s=1,rootMargin:n="50px"})=>{Object(r.useEffect)(()=>{const r=new IntersectionObserver(t,{root:e,rootMargin:n,threshold:s});if(!d(a))return r.observe(a),()=>r.unobserve(a)},[a,e,n,t,s])};var q=({recipe:e})=>{const{id:a,image:t,title:r,description:n,created:c,userId:i}=e,o=u+"assets/images/cookie.jpeg";return s.a.createElement("li",{className:"recipeItem"},s.a.createElement(l.b,{to:"/recipe/"+a},s.a.createElement("figure",{className:"card-image",style:{backgroundImage:`url(${t||o})`}},s.a.createElement("img",{src:t||o,alt:"recipe"})),s.a.createElement("div",{className:"card-desc"},s.a.createElement("h1",null,r),s.a.createElement("p",null,n.length>30?n.substring(0,30)+"...":n),s.a.createElement("p",{className:"card-created"},null==c?void 0:c.substr(0,10)),s.a.createElement("p",null,"by"," ",s.a.createElement("strong",null,p(i)("@"))))))};const x=({recipesBook:e})=>d(e.length)?s.a.createElement("div",null,"Empty"):s.a.createElement("ul",{className:"recipeList"},e.map(e=>s.a.createElement(q,{key:e.id,recipe:e})));var z=s.a.memo(x);var G=()=>{const{recipes:e}=Object(i.c)(e=>({recipes:e.recipes})),{recipesBook:a}=e;return d(a.length)?s.a.createElement(m,null):s.a.createElement("article",null,s.a.createElement(z,{recipesBook:a}))};const Q=async e=>{const a=N.collection("recipes");let t;var r;return t=d(e)?await a.orderBy("created","desc").limit(12).get():await a.orderBy("created","desc").startAfter((r=(null==e?void 0:e.created)||"",y.Timestamp.fromDate(new Date(r)))).limit(12).get(),t.docs},{actions:T,reducer:H}=Object(v.b)({name:"recipes",initialState:{recipesBook:[],lastRecipe:{recipe:null,isLast:!1}},reducers:{setRecipes:(e,{payload:a})=>({...e,recipesBook:[...a]}),setLastRecipe:(e,{payload:{name:a,value:t}})=>({...e,lastRecipe:{...e.lastRecipe,[a]:t}}),addRecipes:(e,{payload:a})=>({...e,recipesBook:[...e.recipesBook,...a]})}}),J=()=>async(e,a)=>{const{recipes:{lastRecipe:{recipe:t,isLast:r}}}=a();if(r)return;const s=await Q(t);if(d(s))return void e(T.setRecipes([]));const n=s.map(e=>(e=>{const{created:a,updated:t}=e.data(),{userId:r,title:s,product:n,category:c,newIngredient:i,ingredients:l,description:o,upload:m,image:u,show:d}=e.data();return{id:e.id,userId:r,title:s,product:n,category:c,newIngredient:i,ingredients:l,description:o,upload:m,image:u,show:d,created:g(a),updated:g(t)}})(e)),c=n.length<12;e(T.addRecipes(n)),e(T.setLastRecipe({name:"recipe",value:n.splice(-1)[0]})),e(T.setLastRecipe({name:"isLast",value:c}))},{setRecipes:K,setLastRecipe:P,addRecipes:V}=T;var W=H;var Y=()=>{const e=Object(i.b)(),[a,t]=Object(r.useState)(null);return D({target:a,onIntersect:([{isIntersecting:a}])=>{a&&e(J())}}),s.a.createElement(s.a.Fragment,null,s.a.createElement(G,null),s.a.createElement("div",{ref:t}))};var $=()=>{const e=Object(i.b)();return Object(r.useEffect)(()=>{e(j())},[e]),s.a.createElement(s.a.Fragment,null,s.a.createElement(r.Suspense,{fallback:s.a.createElement(m,null)},s.a.createElement(M,null),s.a.createElement("div",{className:"main"},s.a.createElement(o.c,null,s.a.createElement(o.a,{exact:!0,path:"/",component:Y}),s.a.createElement(o.a,{component:C})))))},X=t(17);var Z=Object(X.b)({user:F,recipes:W});var _=Object(v.a)({reducer:Z});c.a.render(s.a.createElement(i.a,{store:_},s.a.createElement(l.a,{basename:"/MyBakingRecipeVol2"},s.a.createElement($,null))),document.getElementById("app"))}},[[47,1,4,11,8,7,12,10,5,14,9,6,13,3,2]]]);