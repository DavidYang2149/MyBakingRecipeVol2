(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{47:function(e,a,t){"use strict";t.r(a);var s=t(1),r=t.n(s),c=t(23),n=t.n(c),i=t(14),l=t(15),o=t(5);var m=()=>r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"loadingAnimation"}));const u=e=>!e,p=e=>a=>e.split(a)[0],d=e=>e.toDate().toISOString();var g=({userId:e,onSignIn:a,onSignOut:t})=>{const s="https://davidyang2149.github.io/MyBakingRecipeVol2/static/css/";return r.a.createElement("nav",{className:"header"},r.a.createElement("div",null,r.a.createElement(l.b,{to:"/"},r.a.createElement("img",{className:"homeImg",src:s+"assets/images/home.svg",alt:"Home"})),r.a.createElement(l.b,{to:"/"},r.a.createElement("h1",{className:"homeH1"},"My Baking Recipe"))),e?r.a.createElement("div",{className:"userInfo"},r.a.createElement("p",{className:"userName"},r.a.createElement(l.b,{to:"/"},p(e)("@"))),r.a.createElement("button",{className:"headerButton",type:"button"},"New Recipe"),r.a.createElement("button",{className:"headerButton",type:"button",onClick:t},"Logout"),r.a.createElement("img",{className:"userIcon",src:s+"assets/images/new-recipe.svg",alt:"New Recipe"}),r.a.createElement("img",{className:"userIcon",src:s+"assets/images/close-outline.svg",onClick:t,alt:"Logout"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"headerButton",type:"button",onClick:a},"Sign in (Google)"),r.a.createElement("img",{className:"userIcon",src:s+"assets/images/login-google.svg",onClick:a,alt:"singIn"})))},E=t(18),v=t(19);t(42),t(48),t(45);var b={apiKey:"AIzaSyBWq2ijQg3f9QqIx3gDKsYda0wIeed5zqE",authDomain:"mybakingrecipe.firebaseapp.com",databaseURL:"https://mybakingrecipe-default-rtdb.firebaseio.com",projectId:"mybakingrecipe",storageBucket:"mybakingrecipe.appspot.com",messagingSenderId:"915152243690",appId:"1:915152243690:web:eabd6afc6124e887434093",measurementId:"G-R8B8QCRYLB",status:"production"};v.a.initializeApp(b);const h=v.a.auth(),y=v.a.firestore,I=v.a.firestore(),N=new v.a.auth.GoogleAuthProvider,k=(v.a.storage(),(e,a)=>{sessionStorage.setItem(e,a)}),R={userId:"",displayName:""},{actions:w,reducer:f}=Object(E.b)({name:"user",initialState:R,reducers:{setUser:(e,{payload:{name:a,value:t}})=>({...e,[a]:t}),clearUser:e=>({...e,...R})}}),B=()=>async e=>{try{const{user:a}=await(async()=>await h.signInWithPopup(N))(),t=(null==a?void 0:a.email)||"";k("user",t),e(w.setUser({name:"userId",value:t}))}catch(e){throw new Error(e.message)}},O=()=>async e=>{var a;await(async()=>{await h.signOut()})(),a="user",sessionStorage.removeItem(a),e(w.clearUser())},S=()=>e=>{setTimeout(()=>{const a=h.currentUser,t=(null==a?void 0:a.email)||(s="user",sessionStorage.getItem(s))||"";var s;u(t)?e(w.clearUser()):(k("user",t),e(w.setUser({name:"userId",value:t})))},500)},{setUser:j,clearUser:L}=w;var U=f;var M=()=>{const e=Object(i.b)(),{user:{userId:a}}=Object(i.c)(e=>({user:e.user}));return r.a.createElement(g,{userId:a,onSignIn:()=>{e(B())},onSignOut:()=>{e(O())}})};var F=()=>r.a.createElement("div",{className:"theNotFoundModal"},r.a.createElement("img",{className:"theNotFoundImage",src:"https://davidyang2149.github.io/MyBakingRecipeVol2/static/css/assets/images/page-not-found.svg",alt:"recipe"}),r.a.createElement("p",{className:"theNotFoundTitle"},"해당 페이지를 찾을 수 없습니다."));var A=()=>r.a.createElement(F,null);var C=({root:e=null,target:a,onIntersect:t,threshold:r=1,rootMargin:c="50px"})=>{Object(s.useEffect)(()=>{const s=new IntersectionObserver(t,{root:e,rootMargin:c,threshold:r});if(!u(a))return s.observe(a),()=>s.unobserve(a)},[a,e,c,t,r])};var D=({recipe:e})=>{const{id:a,image:t,title:s,description:c,created:n,userId:i}=e,o="https://davidyang2149.github.io/MyBakingRecipeVol2/static/css/assets/images/cookie.jpeg";return r.a.createElement("li",{className:"recipeItem"},r.a.createElement(l.b,{to:"/recipe/"+a},r.a.createElement("figure",{className:"card-image",style:{backgroundImage:`url(${t||o})`}},r.a.createElement("img",{src:t||o,alt:"recipe"})),r.a.createElement("div",{className:"card-desc"},r.a.createElement("h1",null,s),r.a.createElement("p",null,c.length>30?c.substring(0,30)+"...":c),r.a.createElement("p",{className:"card-created"},null==n?void 0:n.substr(0,10)),r.a.createElement("p",null,"by"," ",r.a.createElement("strong",null,p(i)("@"))))))};const V=({recipesBook:e})=>u(e.length)?r.a.createElement("div",null,"Empty"):r.a.createElement("ul",{className:"recipeList"},e.map(e=>r.a.createElement(D,{key:e.id,recipe:e})));var q=r.a.memo(V);var x=()=>{const{recipes:e}=Object(i.c)(e=>({recipes:e.recipes})),{recipesBook:a}=e;return u(a.length)?r.a.createElement(m,null):r.a.createElement("article",null,r.a.createElement(q,{recipesBook:a}))};const z=async e=>{const a=I.collection("recipes");let t;var s;return t=u(e)?await a.orderBy("created","desc").limit(12).get():await a.orderBy("created","desc").startAfter((s=(null==e?void 0:e.created)||"",y.Timestamp.fromDate(new Date(s)))).limit(12).get(),t.docs},{actions:G,reducer:Q}=Object(E.b)({name:"recipes",initialState:{recipesBook:[],lastRecipe:{recipe:null,isLast:!1}},reducers:{setRecipes:(e,{payload:a})=>({...e,recipesBook:[...a]}),setLastRecipe:(e,{payload:{name:a,value:t}})=>({...e,lastRecipe:{...e.lastRecipe,[a]:t}}),addRecipes:(e,{payload:a})=>({...e,recipesBook:[...e.recipesBook,...a]})}}),T=()=>async(e,a)=>{const{recipes:{lastRecipe:{recipe:t,isLast:s}}}=a();if(s)return;const r=await z(t);if(u(r))return void e(G.setRecipes([]));const c=r.map(e=>(e=>{const{created:a,updated:t}=e.data();return{...e.data(),id:e.id,created:d(a),updated:d(t)}})(e)),n=c.length<12;e(G.addRecipes(c)),e(G.setLastRecipe({name:"recipe",value:c.splice(-1)[0]})),e(G.setLastRecipe({name:"isLast",value:n}))},{setRecipes:H,setLastRecipe:J,addRecipes:K}=G;var P=Q;var W=()=>{const e=Object(i.b)(),[a,t]=Object(s.useState)(null);return C({target:a,onIntersect:([{isIntersecting:a}])=>{a&&e(T())}}),r.a.createElement(r.a.Fragment,null,r.a.createElement(x,null),r.a.createElement("div",{ref:t}))};var Y=()=>{const e=Object(i.b)();return Object(s.useEffect)(()=>{e(S())},[e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.Suspense,{fallback:r.a.createElement(m,null)},r.a.createElement(M,null),r.a.createElement("div",{className:"main"},r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:"/",component:W}),r.a.createElement(o.a,{component:A})))))},$=t(17);var X=Object($.b)({user:U,recipes:P});var Z=Object(E.a)({reducer:X});n.a.render(r.a.createElement(i.a,{store:Z},r.a.createElement(l.a,{basename:"/MyBakingRecipeVol2"},r.a.createElement(Y,null))),document.getElementById("app"))}},[[47,1,4,11,8,7,12,10,5,14,9,6,13,3,2]]]);