(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{47:function(e,a,t){"use strict";t.r(a);var s=t(1),r=t.n(s),c=t(23),n=t.n(c),l=t(14),i=t(15),o=t(5);var m=()=>r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"loadingAnimation"}));const u="https://davidyang2149.github.io/MyBakingRecipeVol2/static/css/",p=e=>!e,d=e=>a=>e.split(a)[0],g=e=>e.toDate().toISOString();var E=({userId:e,onSignIn:a,onSignOut:t})=>r.a.createElement("nav",{className:"header"},r.a.createElement("div",null,r.a.createElement(i.b,{to:"/"},r.a.createElement("img",{className:"homeImg",src:u+"assets/images/home.svg",alt:"Home"})),r.a.createElement(i.b,{to:"/"},r.a.createElement("h1",{className:"homeH1"},"My Baking Recipe"))),e?r.a.createElement("div",{className:"userInfo"},r.a.createElement("p",{className:"userName"},r.a.createElement(i.b,{to:"/"},d(e)("@"))),r.a.createElement("button",{className:"headerButton",type:"button"},"New Recipe"),r.a.createElement("button",{className:"headerButton",type:"button",onClick:t},"Logout"),r.a.createElement("img",{className:"userIcon",src:u+"assets/images/new-recipe.svg",alt:"New Recipe"}),r.a.createElement("img",{className:"userIcon",src:u+"assets/images/close-outline.svg",onClick:t,alt:"Logout"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"headerButton",type:"button",onClick:a},"Sign in (Google)"),r.a.createElement("img",{className:"userIcon",src:u+"assets/images/login-google.svg",onClick:a,alt:"singIn"}))),v=t(18),b=t(19);t(42),t(48),t(45);var I={apiKey:"AIzaSyBWq2ijQg3f9QqIx3gDKsYda0wIeed5zqE",authDomain:"mybakingrecipe.firebaseapp.com",databaseURL:"https://mybakingrecipe-default-rtdb.firebaseio.com",projectId:"mybakingrecipe",storageBucket:"mybakingrecipe.appspot.com",messagingSenderId:"915152243690",appId:"1:915152243690:web:eabd6afc6124e887434093",measurementId:"G-R8B8QCRYLB",status:"production"};b.a.initializeApp(I);const h=b.a.auth(),y=b.a.firestore,N=b.a.firestore(),k=new b.a.auth.GoogleAuthProvider,w=(b.a.storage(),(e,a)=>{sessionStorage.setItem(e,a)}),f={userId:"",displayName:""},{actions:R,reducer:B}=Object(v.b)({name:"user",initialState:f,reducers:{setUser:(e,{payload:{name:a,value:t}})=>({...e,[a]:t}),clearUser:e=>({...e,...f})}}),O=()=>async e=>{try{const{user:a}=await(async()=>await h.signInWithPopup(k))(),t=(null==a?void 0:a.email)||"";w("user",t),e(R.setUser({name:"userId",value:t}))}catch(e){throw new Error(e.message)}},S=()=>async e=>{var a;await(async()=>{await h.signOut()})(),a="user",sessionStorage.removeItem(a),e(R.clearUser())},j=()=>e=>{setTimeout(()=>{const a=h.currentUser,t=(null==a?void 0:a.email)||(s="user",sessionStorage.getItem(s))||"";var s;p(t)?e(R.clearUser()):(w("user",t),e(R.setUser({name:"userId",value:t})))},500)},{setUser:L,clearUser:U}=R;var F=B;var M=()=>{const e=Object(l.b)(),{user:{userId:a}}=Object(l.c)(e=>({user:e.user}));return r.a.createElement(E,{userId:a,onSignIn:()=>{e(O())},onSignOut:()=>{e(S())}})};var A=()=>r.a.createElement("div",{className:"theNotFoundModal"},r.a.createElement("img",{className:"theNotFoundImage",src:u+"assets/images/page-not-found.svg",alt:"recipe"}),r.a.createElement("p",{className:"theNotFoundTitle"},"해당 페이지를 찾을 수 없습니다."));var C=()=>r.a.createElement(A,null);var D=({root:e=null,target:a,onIntersect:t,threshold:r=1,rootMargin:c="50px"})=>{Object(s.useEffect)(()=>{const s=new IntersectionObserver(t,{root:e,rootMargin:c,threshold:r});if(!p(a))return s.observe(a),()=>s.unobserve(a)},[a,e,c,t,r])};var q=({recipe:e})=>{const{id:a,image:t,title:s,description:c,created:n,userId:l}=e,o=u+"assets/images/cookie.jpeg";return r.a.createElement("li",{className:"recipeItem"},r.a.createElement(i.b,{to:"/recipe/"+a},r.a.createElement("figure",{className:"card-image",style:{backgroundImage:`url(${t||o})`}},r.a.createElement("img",{src:t||o,alt:"recipe"})),r.a.createElement("div",{className:"card-desc"},r.a.createElement("h1",null,s),r.a.createElement("p",null,c.length>30?c.substring(0,30)+"...":c),r.a.createElement("p",{className:"card-created"},null==n?void 0:n.substr(0,10)),r.a.createElement("p",null,"by"," ",r.a.createElement("strong",null,d(l)("@"))))))};const x=({recipesBook:e})=>p(e.length)?r.a.createElement("div",null,"Empty"):r.a.createElement("ul",{className:"recipeList"},e.map(e=>r.a.createElement(q,{key:e.id,recipe:e})));var z=r.a.memo(x);var G=()=>{const{recipes:e}=Object(l.c)(e=>({recipes:e.recipes})),{recipesBook:a}=e;return p(a.length)?r.a.createElement(m,null):r.a.createElement("article",null,r.a.createElement(z,{recipesBook:a}))};const Q=async e=>{const a=N.collection("recipes");let t;var s;return t=p(e)?await a.orderBy("created","desc").limit(12).get():await a.orderBy("created","desc").startAfter((s=(null==e?void 0:e.created)||"",y.Timestamp.fromDate(new Date(s)))).limit(12).get(),t.docs},{actions:T,reducer:H}=Object(v.b)({name:"recipes",initialState:{recipesBook:[],lastRecipe:{recipe:null,isLast:!1}},reducers:{setRecipes:(e,{payload:a})=>({...e,recipesBook:[...a]}),setLastRecipe:(e,{payload:{name:a,value:t}})=>({...e,lastRecipe:{...e.lastRecipe,[a]:t}}),addRecipes:(e,{payload:a})=>({...e,recipesBook:[...e.recipesBook,...a]})}}),J=()=>async(e,a)=>{const{recipes:{lastRecipe:{recipe:t,isLast:s}}}=a();if(s)return;const r=await Q(t);if(p(r))return void e(T.setRecipes([]));const c=r.map(e=>(e=>{const{created:a,updated:t}=e.data();return{...e.data(),id:e.id,created:g(a),updated:g(t)}})(e)),n=c.length<12;e(T.addRecipes(c)),e(T.setLastRecipe({name:"recipe",value:c.splice(-1)[0]})),e(T.setLastRecipe({name:"isLast",value:n}))},{setRecipes:K,setLastRecipe:P,addRecipes:V}=T;var W=H;var Y=()=>{const e=Object(l.b)(),[a,t]=Object(s.useState)(null);return D({target:a,onIntersect:([{isIntersecting:a}])=>{a&&e(J())}}),r.a.createElement(r.a.Fragment,null,r.a.createElement(G,null),r.a.createElement("div",{ref:t}))};var $=()=>{const e=Object(l.b)();return Object(s.useEffect)(()=>{e(j())},[e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.Suspense,{fallback:r.a.createElement(m,null)},r.a.createElement(M,null),r.a.createElement("div",{className:"main"},r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:"/",component:Y}),r.a.createElement(o.a,{component:C})))))},X=t(17);var Z=Object(X.b)({user:F,recipes:W});var _=Object(v.a)({reducer:Z});n.a.render(r.a.createElement(l.a,{store:_},r.a.createElement(i.a,{basename:"/MyBakingRecipeVol2"},r.a.createElement($,null))),document.getElementById("app"))}},[[47,1,4,11,8,7,12,10,5,14,9,6,13,3,2]]]);