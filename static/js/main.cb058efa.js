(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{60:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(25),l=a.n(c),i=a(8),s=a(19),o=a(6);var m=()=>r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"loadingAnimation"}));const d="https://davidyang2149.github.io/MyBakingRecipeVol2/static/css/",u=e=>!e,p=e=>t=>e.split(t)[0],g=e=>e.toDate().toISOString(),E=e=>{const{created:t,updated:a}=e.data(),{userId:n,title:r,product:c,category:l,newIngredient:i,ingredients:s,description:o,upload:m,image:d,show:u}=e.data();return{id:e.id,userId:n,title:r,product:c,category:l,newIngredient:i,ingredients:s,description:o,upload:m,image:d,show:u,created:g(t),updated:g(a)}};var b=({userId:e,onSignIn:t,onSignOut:a})=>r.a.createElement("nav",{className:"header"},r.a.createElement("div",null,r.a.createElement(s.b,{to:"/"},r.a.createElement("img",{className:"homeImg",src:d+"assets/images/home.svg",alt:"Home"})),r.a.createElement(s.b,{to:"/"},r.a.createElement("h1",{className:"homeH1"},"My Baking Recipe"))),e?r.a.createElement("div",{className:"userInfo"},r.a.createElement("p",{className:"userName"},r.a.createElement(s.b,{to:"/"},p(e)("@"))),r.a.createElement("button",{className:"headerButton",type:"button"},"New Recipe"),r.a.createElement("button",{className:"headerButton",type:"button",onClick:a},"Logout"),r.a.createElement("img",{className:"userIcon",src:d+"assets/images/new-recipe.svg",alt:"New Recipe"}),r.a.createElement("img",{className:"userIcon",src:d+"assets/images/close-outline.svg",onClick:a,alt:"Logout"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"headerButton",type:"button",onClick:t},"Sign in (Google)"),r.a.createElement("img",{className:"userIcon",src:d+"assets/images/login-google.svg",onClick:t,alt:"singIn"}))),v=a(21),h=a(24);a(53),a(55),a(58);var y={apiKey:"AIzaSyBWq2ijQg3f9QqIx3gDKsYda0wIeed5zqE",authDomain:"mybakingrecipe.firebaseapp.com",databaseURL:"https://mybakingrecipe-default-rtdb.firebaseio.com",projectId:"mybakingrecipe",storageBucket:"mybakingrecipe.appspot.com",messagingSenderId:"915152243690",appId:"1:915152243690:web:eabd6afc6124e887434093",measurementId:"G-R8B8QCRYLB",status:"production"};h.a.initializeApp(y);const I=h.a.auth(),N=h.a.firestore,w=h.a.firestore(),f=new h.a.auth.GoogleAuthProvider,R=(h.a.storage(),(e,t)=>{sessionStorage.setItem(e,t)}),k={userId:"",displayName:""},{actions:O,reducer:j}=Object(v.b)({name:"user",initialState:k,reducers:{setUser:(e,{payload:{name:t,value:a}})=>({...e,[t]:a}),clearUser:e=>({...e,...k})}}),C=()=>async e=>{try{const{user:t}=await(async()=>await I.signInWithPopup(f))(),a=(null==t?void 0:t.email)||"";R("user",a),e(O.setUser({name:"userId",value:a}))}catch(e){throw new Error(e.message)}},x=()=>async e=>{var t;await(async()=>{await I.signOut()})(),t="user",sessionStorage.removeItem(t),e(O.clearUser())},B=()=>e=>{setTimeout(()=>{const t=I.currentUser,a=(null==t?void 0:t.email)||(n="user",sessionStorage.getItem(n))||"";var n;u(a)?e(O.clearUser()):(R("user",a),e(O.setUser({name:"userId",value:a})))},500)},{setUser:S,clearUser:L}=O;var F=j;var D=()=>{const e=Object(i.c)(),{user:{userId:t}}=Object(i.d)(e=>({user:e.user}));return r.a.createElement(b,{userId:t,onSignIn:()=>{e(C())},onSignOut:()=>{e(x())}})};var U=()=>r.a.createElement("div",{className:"theNotFoundModal"},r.a.createElement("img",{className:"theNotFoundImage",src:d+"assets/images/page-not-found.svg",alt:"recipe"}),r.a.createElement("p",{className:"theNotFoundTitle"},"해당 페이지를 찾을 수 없습니다."));var P=()=>r.a.createElement(U,null);const M=({title:e})=>r.a.createElement("p",{className:"recipeTitle"},e);var A=r.a.memo(M);const T=({user:e,created:t})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"recipeWriter"},e)," ",r.a.createElement("span",{className:"recipeWriteDate"},t.substr(0,10)),r.a.createElement("hr",{className:"recipeWriteLine"}));var W=r.a.memo(T);const q=({image:e})=>r.a.createElement("section",null,r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"displayImage",className:"recipeImageLabel"},"이미지"),r.a.createElement("img",{id:"displayImage",src:e||"images/cookie.jpeg",width:"200px",height:"200px",alt:"recipe"})));var z=r.a.memo(q);const G=({title:e,category:t,product:a,onChange:n})=>r.a.createElement("section",null,n?r.a.createElement("label",{htmlFor:"title",className:"recipeDutyLabel"},"레시피명"):r.a.createElement("label",{htmlFor:"title",className:"recipeLabel"},"레시피명"),r.a.createElement("input",{type:"text",id:"title",name:"title",className:"recipeInput",value:e,onChange:n,disabled:!n}),n?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"category",className:"recipeDutyLabel"},"카테고리"),r.a.createElement("label",{htmlFor:"product",className:"recipeDutyLabel"},"생산량")):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"category",className:"recipeLabel"},"카테고리"),r.a.createElement("label",{htmlFor:"product",className:"recipeLabel"},"생산량")),r.a.createElement("div",null,r.a.createElement("select",{id:"category",name:"category",className:"recipeSelect",value:t,onChange:n,disabled:!n},[{value:0,text:"선택"},{value:1,text:"쿠키"},{value:2,text:"구움과자"},{value:3,text:"케이크"},{value:4,text:"빵"},{value:5,text:"마카롱"},{value:6,text:"기타"}].map(({value:e,text:t})=>r.a.createElement("option",{key:e,value:e},t))),r.a.createElement("input",{type:"number",min:"0",max:"1000000000",id:"product",name:"product",className:"recipeInput",value:a,onChange:n,disabled:!n}),r.a.createElement("span",{className:"recipeCount"},"개")));var H=r.a.memo(G);const Q=({description:e,onChange:t})=>r.a.createElement("section",null,r.a.createElement("label",{htmlFor:"description",className:t?"recipeDutyDescription":"recipeDescription"},"만드는 방법"),r.a.createElement("textarea",{id:"description",name:"description",className:"recipeTextarea",value:e,onChange:t,disabled:!t}));var J=r.a.memo(Q),K=a(35);function V(){return(V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const Y=({id:e,ingredient:t,weight:a,onChangeIngredient:n,onRemoveIngredient:c,provided:l})=>l?r.a.createElement("li",V({ref:l.innerRef},l.dragHandleProps,l.draggableProps),r.a.createElement("span",{className:"hamburger"}),r.a.createElement("input",{type:"text",id:"ingredient-"+e,name:"ingredient-"+e,className:"ingredientInput",value:t,onChange:n,width:"24%"}),r.a.createElement("input",{type:"number",min:"0",max:"1000000000",id:"weight-"+e,name:"weight-"+e,className:"ingredientInput",value:a,onChange:n,width:"13%"}),r.a.createElement("span",{className:"ingredientCount"},"g"),r.a.createElement("button",{type:"button",className:"ingredientDeleteButton",onClick:c,value:e},"삭제")):r.a.createElement("li",null,r.a.createElement("input",{type:"text",id:"ingredient-"+e,name:"ingredient-"+e,className:"ingredientInput",value:t,disabled:!0}),r.a.createElement("input",{type:"number",min:"0",max:"1000000000",id:"weight-"+e,name:"weight-"+e,className:"ingredientInput",value:a,onChange:n,disabled:!0}),r.a.createElement("span",{className:"ingredientCount"},"g"));var $=r.a.memo(Y);function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const Z=({ingredients:e,onChangeIngredient:t,onRemoveIngredient:a,onDragEndIngredient:n})=>n?r.a.createElement("section",null,r.a.createElement(K.a,{onDragEnd:n},r.a.createElement(K.c,{droppableId:"ingredients"},n=>r.a.createElement("ul",X({className:"ingredients",ref:n.innerRef},n.droppableProps),e.map(({id:e,ingredient:n,weight:c},l)=>r.a.createElement(K.b,{key:e.toString(),draggableId:e.toString(),index:l},l=>r.a.createElement($,{key:e,id:e,ingredient:n,weight:c,onChangeIngredient:t,onRemoveIngredient:a,provided:l}))),n.placeholder)))):r.a.createElement("section",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("label",{className:"ingredientName"},"원재료"),r.a.createElement("label",{className:"ingredientName"},"용량")),e.map(({id:e,ingredient:n,weight:c})=>r.a.createElement($,{key:e,id:e,ingredient:n,weight:c,onChangeIngredient:t,onRemoveIngredient:a}))));var _=r.a.memo(Z);var ee=()=>{Object(i.c)();const e=Object(o.f)(),[t,a]=Object(n.useState)(!1),{user:c,recipe:l}=Object(i.d)(e=>({user:e.user,recipe:e.recipe})),{id:d,userId:u,title:p,category:g,product:E,ingredients:b,description:v,image:h,created:y}=l,I=Object(n.useCallback)(()=>{window.confirm("레시피를 삭제하시겠습니까?")&&(a(!0),e.push("/"))},[e]);return d?r.a.createElement("article",null,r.a.createElement(A,{title:p}),r.a.createElement(W,{user:u,created:y||""}),r.a.createElement(z,{image:h||""}),r.a.createElement(H,{title:p,category:g,product:E}),r.a.createElement(_,{ingredients:b}),r.a.createElement(J,{description:v}),!!u&&u===c.userId&&r.a.createElement("section",null,r.a.createElement(s.b,{to:"/recipewrite/"+d},r.a.createElement("button",{type:"button",className:"button"},"수정하기")),r.a.createElement("button",{type:"button",className:"button",onClick:I,disabled:t},"삭제하기")),t&&r.a.createElement(m,null)):r.a.createElement(m,null)};const te=async e=>{const t=w.collection("recipes");let a;var n;return a=u(e)?await t.orderBy("created","desc").limit(12).get():await t.orderBy("created","desc").startAfter((n=(null==e?void 0:e.created)||"",N.Timestamp.fromDate(new Date(n)))).limit(12).get(),a.docs},ae={id:"",userId:"",title:"",category:0,product:0,ingredients:[],newIngredient:{id:0,ingredient:"",weight:0},description:"",upload:null,image:null,show:!1,created:"",updated:""},{actions:ne,reducer:re}=Object(v.b)({name:"recipe",initialState:ae,reducers:{setRecipe:(e,{payload:t})=>({...e,...t,newIngredient:{id:t.ingredients.length+1,ingredient:"",weight:0}}),clearRecipe:e=>({...e,...ae})}}),ce=e=>async t=>{const a=await(async({id:e})=>{const t=w.collection("recipes");return await t.doc(e).get()})({id:e});a.exists?t(ne.setRecipe(E(a))):t(ne.setRecipe(ae))},{setRecipe:le,clearRecipe:ie}=ne;var se=re;var oe=()=>{const e=Object(i.c)(),{id:t}=Object(o.g)();return Object(n.useEffect)(()=>{e(ie()),e(ce(t))},[e,t]),r.a.createElement(ee,null)};var me=({root:e=null,target:t,onIntersect:a,threshold:r=1,rootMargin:c="50px"})=>{Object(n.useEffect)(()=>{const n=new IntersectionObserver(a,{root:e,rootMargin:c,threshold:r});if(!u(t))return n.observe(t),()=>n.unobserve(t)},[t,e,c,a,r])};var de=({recipe:e})=>{const{id:t,image:a,title:n,description:c,created:l,userId:i}=e,o=d+"assets/images/cookie.jpeg";return r.a.createElement("li",{className:"recipeItem"},r.a.createElement(s.b,{to:"/recipe/"+t},r.a.createElement("figure",{className:"card-image",style:{backgroundImage:`url(${a||o})`}},r.a.createElement("img",{src:a||o,alt:"recipe"})),r.a.createElement("div",{className:"card-desc"},r.a.createElement("h1",null,n),r.a.createElement("p",null,c.length>30?c.substring(0,30)+"...":c),r.a.createElement("p",{className:"card-created"},null==l?void 0:l.substr(0,10)),r.a.createElement("p",null,"by"," ",r.a.createElement("strong",null,p(i)("@"))))))};const ue=({recipesBook:e})=>u(e.length)?r.a.createElement("div",null,"Empty"):r.a.createElement("ul",{className:"recipeList"},e.map(e=>r.a.createElement(de,{key:e.id,recipe:e})));var pe=r.a.memo(ue);var ge=()=>{const{recipes:e}=Object(i.d)(e=>({recipes:e.recipes})),{recipesBook:t}=e;return u(t.length)?r.a.createElement(m,null):r.a.createElement("article",null,r.a.createElement(pe,{recipesBook:t}))};const{actions:Ee,reducer:be}=Object(v.b)({name:"recipes",initialState:{recipesBook:[],lastRecipe:{recipe:null,isLast:!1}},reducers:{setRecipes:(e,{payload:t})=>({...e,recipesBook:[...t]}),setLastRecipe:(e,{payload:{name:t,value:a}})=>({...e,lastRecipe:{...e.lastRecipe,[t]:a}}),addRecipes:(e,{payload:t})=>({...e,recipesBook:[...e.recipesBook,...t]})}}),{setRecipes:ve,setLastRecipe:he,addRecipes:ye}=Ee;var Ie=be;var Ne=()=>{const e=Object(i.c)(),[t,a]=Object(n.useState)(null);return me({target:t,onIntersect:([{isIntersecting:t}])=>{t&&e(async(e,t)=>{const{recipes:{lastRecipe:{recipe:a,isLast:n}}}=t();if(n)return;const r=await te(a);if(u(r))return void e(Ee.setRecipes([]));const c=r.map(e=>E(e)),l=c.length<12;e(Ee.addRecipes(c)),e(Ee.setLastRecipe({name:"recipe",value:c.splice(-1)[0]})),e(Ee.setLastRecipe({name:"isLast",value:l}))})}}),r.a.createElement(r.a.Fragment,null,r.a.createElement(ge,null),r.a.createElement("div",{ref:a}))};var we=()=>{const e=Object(i.c)();return Object(n.useEffect)(()=>{e(B())},[e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(n.Suspense,{fallback:r.a.createElement(m,null)},r.a.createElement(D,null),r.a.createElement("div",{className:"main"},r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:"/",component:Ne}),r.a.createElement(o.a,{path:"/recipe/:id",component:oe}),r.a.createElement(o.a,{component:P})))))},fe=a(16);var Re=Object(fe.c)({user:F,recipe:se,recipes:Ie});var ke=Object(v.a)({reducer:Re});l.a.render(r.a.createElement(i.a,{store:ke},r.a.createElement(s.a,{basename:"/MyBakingRecipeVol2"},r.a.createElement(we,null))),document.getElementById("app"))}},[[60,1,4,12,9,8,13,11,6,14,10,16,7,15,2,3,5]]]);