(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{47:function(e,a,t){"use strict";t.r(a);var s=t(1),r=t.n(s),c=t(23),n=t.n(c),l=t(14),i=t(15),o=t(5);var m=()=>r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"loadingAnimation"}));const u=e=>!e,p=e=>a=>e.split(a)[0],d=e=>e.toDate().toISOString();var g=({userId:e,onSignIn:a,onSignOut:t})=>r.a.createElement("nav",{className:"header"},r.a.createElement("div",null,r.a.createElement(i.b,{to:"/"},r.a.createElement("img",{src:"assets/images/home.svg",alt:"Home",className:"homeImg"})),r.a.createElement(i.b,{to:"/"},r.a.createElement("h1",{className:"homeH1"},"My Baking Recipe"))),e?r.a.createElement("div",{className:"userInfo"},r.a.createElement("p",{className:"userName"},r.a.createElement(i.b,{to:"/"},p(e)("@"))),r.a.createElement("button",{className:"headerButton",type:"button"},"New Recipe"),r.a.createElement("button",{className:"headerButton",type:"button",onClick:t},"Logout"),r.a.createElement("img",{className:"userIcon",src:"assets/images/new-recipe.svg",alt:"New Recipe"}),r.a.createElement("img",{className:"userIcon",src:"assets/images/close-outline.svg",onClick:t,alt:"Logout"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"headerButton",type:"button",onClick:a},"Sign in (Google)"),r.a.createElement("img",{className:"userIcon",src:"assets/images/login-google.svg",onClick:a,alt:"singIn"}))),E=t(18),v=t(19);t(42),t(48),t(45);var b={apiKey:"AIzaSyBWq2ijQg3f9QqIx3gDKsYda0wIeed5zqE",authDomain:"mybakingrecipe.firebaseapp.com",databaseURL:"https://mybakingrecipe-default-rtdb.firebaseio.com",projectId:"mybakingrecipe",storageBucket:"mybakingrecipe.appspot.com",messagingSenderId:"915152243690",appId:"1:915152243690:web:eabd6afc6124e887434093",measurementId:"G-R8B8QCRYLB",status:"production"};v.a.initializeApp(b);const I=v.a.auth(),h=v.a.firestore,y=v.a.firestore(),N=new v.a.auth.GoogleAuthProvider,k=(v.a.storage(),(e,a)=>{sessionStorage.setItem(e,a)}),w={userId:"",displayName:""},{actions:f,reducer:R}=Object(E.b)({name:"user",initialState:w,reducers:{setUser:(e,{payload:{name:a,value:t}})=>({...e,[a]:t}),clearUser:e=>({...e,...w})}}),B=()=>async e=>{try{const{user:a}=await(async()=>await I.signInWithPopup(N))(),t=(null==a?void 0:a.email)||"";k("user",t),e(f.setUser({name:"userId",value:t}))}catch(e){throw new Error(e.message)}},O=()=>async e=>{var a;await(async()=>{await I.signOut()})(),a="user",sessionStorage.removeItem(a),e(f.clearUser())},j=()=>e=>{setTimeout(()=>{const a=I.currentUser,t=(null==a?void 0:a.email)||(s="user",sessionStorage.getItem(s))||"";var s;u(t)?e(f.clearUser()):(k("user",t),e(f.setUser({name:"userId",value:t})))},500)},{setUser:S,clearUser:L}=f;var U=R;var F=()=>{const e=Object(l.b)(),{user:{userId:a}}=Object(l.c)(e=>({user:e.user}));return r.a.createElement(g,{userId:a,onSignIn:()=>{e(B())},onSignOut:()=>{e(O())}})};var A=()=>r.a.createElement("div",{className:"theNotFoundModal"},r.a.createElement("img",{className:"theNotFoundImage",id:"displayImage",src:"assets/images/page-not-found.svg",alt:"recipe"}),r.a.createElement("p",{className:"theNotFoundTitle"},"해당 페이지를 찾을 수 없습니다."));var C=()=>r.a.createElement(A,null);var D=({root:e=null,target:a,onIntersect:t,threshold:r=1,rootMargin:c="50px"})=>{Object(s.useEffect)(()=>{const s=new IntersectionObserver(t,{root:e,rootMargin:c,threshold:r});if(!u(a))return s.observe(a),()=>s.unobserve(a)},[a,e,c,t,r])};var M=({recipe:e})=>{const{id:a,image:t,title:s,description:c,created:n,userId:l}=e;return r.a.createElement("li",{className:"recipeItem"},r.a.createElement(i.b,{to:"/recipe/"+a},r.a.createElement("figure",{className:"card-image",style:{backgroundImage:`url(${t||"assets/images/cookie.jpeg"})`}},r.a.createElement("img",{src:t||"assets/images/cookie.jpeg",alt:"recipe"})),r.a.createElement("div",{className:"card-desc"},r.a.createElement("h1",null,s),r.a.createElement("p",null,c.length>30?c.substring(0,30)+"...":c),r.a.createElement("p",{className:"card-created"},null==n?void 0:n.substr(0,10)),r.a.createElement("p",null,"by"," ",r.a.createElement("strong",null,p(l)("@"))))))};const q=({recipesBook:e})=>u(e.length)?r.a.createElement("div",null,"Empty"):r.a.createElement("ul",{className:"recipeList"},e.map(e=>r.a.createElement(M,{key:e.id,recipe:e})));var x=r.a.memo(q);var z=()=>{const{recipes:e}=Object(l.c)(e=>({recipes:e.recipes})),{recipesBook:a}=e;return u(a.length)?r.a.createElement(m,null):r.a.createElement("article",null,r.a.createElement(x,{recipesBook:a}))};const G=async e=>{const a=y.collection("recipes");let t;var s;return t=u(e)?await a.orderBy("created","desc").limit(12).get():await a.orderBy("created","desc").startAfter((s=(null==e?void 0:e.created)||"",h.Timestamp.fromDate(new Date(s)))).limit(12).get(),t.docs},{actions:Q,reducer:T}=Object(E.b)({name:"recipes",initialState:{recipesBook:[],lastRecipe:{recipe:null,isLast:!1}},reducers:{setRecipes:(e,{payload:a})=>({...e,recipesBook:[...a]}),setLastRecipe:(e,{payload:{name:a,value:t}})=>({...e,lastRecipe:{...e.lastRecipe,[a]:t}}),addRecipes:(e,{payload:a})=>({...e,recipesBook:[...e.recipesBook,...a]})}}),H=()=>async(e,a)=>{const{recipes:{lastRecipe:{recipe:t,isLast:s}}}=a();if(s)return;const r=await G(t);if(u(r))return void e(Q.setRecipes([]));const c=r.map(e=>(e=>{const{created:a,updated:t}=e.data();return{...e.data(),id:e.id,created:d(a),updated:d(t)}})(e)),n=c.length<12;e(Q.addRecipes(c)),e(Q.setLastRecipe({name:"recipe",value:c.splice(-1)[0]})),e(Q.setLastRecipe({name:"isLast",value:n}))},{setRecipes:J,setLastRecipe:K,addRecipes:P}=Q;var W=T;var Y=()=>{const e=Object(l.b)(),[a,t]=Object(s.useState)(null);return D({target:a,onIntersect:([{isIntersecting:a}])=>{a&&e(H())}}),r.a.createElement(r.a.Fragment,null,r.a.createElement(z,null),r.a.createElement("div",{ref:t}))};var $=()=>{const e=Object(l.b)();return Object(s.useEffect)(()=>{e(j())},[e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.Suspense,{fallback:r.a.createElement(m,null)},r.a.createElement(F,null),r.a.createElement("div",{className:"main"},r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:"/",component:Y}),r.a.createElement(o.a,{component:C})))))},V=t(17);var X=Object(V.b)({user:U,recipes:W});var Z=Object(E.a)({reducer:X});n.a.render(r.a.createElement(l.a,{store:Z},r.a.createElement(i.a,null,r.a.createElement($,null))),document.getElementById("app"))}},[[47,1,4,11,8,7,12,10,5,14,9,6,13,3,2]]]);