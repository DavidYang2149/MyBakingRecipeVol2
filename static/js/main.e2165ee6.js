(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{60:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(25),i=a.n(c),l=a(8),s=a(19),o=a(6);var m=()=>r.a.createElement("div",{className:"modal"},r.a.createElement("div",{className:"loadingAnimation"}));const d="https://davidyang2149.github.io/MyBakingRecipeVol2/static/css/",u=e=>!e,p=e=>e.toDate().toISOString(),g=e=>{const{created:t,updated:a}=e.data(),{userId:n,title:r,product:c,category:i,newIngredient:l,ingredients:s,description:o,upload:m,image:d,show:u}=e.data();return{id:e.id,userId:n,title:r,product:c,category:i,newIngredient:l,ingredients:s,description:o,upload:m,image:d,show:u,created:p(t),updated:p(a)}};var E=({userId:e,onSignIn:t,onSignOut:a})=>{return r.a.createElement("nav",{className:"header"},r.a.createElement("div",null,r.a.createElement(s.b,{to:"/"},r.a.createElement("img",{className:"homeImg",src:d+"assets/images/home.svg",alt:"Home"})),r.a.createElement(s.b,{to:"/"},r.a.createElement("h1",{className:"homeH1"},"My Baking Recipe"))),e?r.a.createElement("div",{className:"userInfo"},r.a.createElement("p",{className:"userName"},r.a.createElement(s.b,{to:"/"},(n=e,e=>n.split(e)[0])("@"))),r.a.createElement("button",{className:"headerButton",type:"button"},"New Recipe"),r.a.createElement("button",{className:"headerButton",type:"button",onClick:a},"Logout"),r.a.createElement("img",{className:"userIcon",src:d+"assets/images/new-recipe.svg",alt:"New Recipe"}),r.a.createElement("img",{className:"userIcon",src:d+"assets/images/close-outline.svg",onClick:a,alt:"Logout"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"headerButton",type:"button",onClick:t},"Sign in (Google)"),r.a.createElement("img",{className:"userIcon",src:d+"assets/images/login-google.svg",onClick:t,alt:"singIn"})));var n},b=a(21),v=a(24);a(53),a(55),a(58);var h={apiKey:"AIzaSyBWq2ijQg3f9QqIx3gDKsYda0wIeed5zqE",authDomain:"mybakingrecipe.firebaseapp.com",databaseURL:"https://mybakingrecipe-default-rtdb.firebaseio.com",projectId:"mybakingrecipe",storageBucket:"mybakingrecipe.appspot.com",messagingSenderId:"915152243690",appId:"1:915152243690:web:eabd6afc6124e887434093",measurementId:"G-R8B8QCRYLB",status:"production"};v.a.initializeApp(h);const y=v.a.auth(),I=v.a.firestore,N=v.a.firestore(),w=new v.a.auth.GoogleAuthProvider,f=(v.a.storage(),(e,t)=>{sessionStorage.setItem(e,t)}),R={userId:"",displayName:""},{actions:k,reducer:O}=Object(b.b)({name:"user",initialState:R,reducers:{setUser:(e,{payload:{name:t,value:a}})=>({...e,[t]:a}),clearUser:e=>({...e,...R})}}),j=()=>async e=>{try{const{user:t}=await(async()=>await y.signInWithPopup(w))(),a=(null==t?void 0:t.email)||"";f("user",a),e(k.setUser({name:"userId",value:a}))}catch(e){throw new Error(e.message)}},C=()=>async e=>{var t;await(async()=>{await y.signOut()})(),t="user",sessionStorage.removeItem(t),e(k.clearUser())},B=()=>e=>{setTimeout(()=>{const t=y.currentUser,a=(null==t?void 0:t.email)||(n="user",sessionStorage.getItem(n))||"";var n;u(a)?e(k.clearUser()):(f("user",a),e(k.setUser({name:"userId",value:a})))},500)},{setUser:S,clearUser:L}=k;var F=O;var x=()=>{const e=Object(l.c)(),{user:{userId:t}}=Object(l.d)(e=>({user:e.user}));return r.a.createElement(E,{userId:t,onSignIn:()=>{e(j())},onSignOut:()=>{e(C())}})};var D=()=>r.a.createElement("div",{className:"theNotFoundModal"},r.a.createElement("img",{className:"theNotFoundImage",src:d+"assets/images/page-not-found.svg",alt:"recipe"}),r.a.createElement("p",{className:"theNotFoundTitle"},"해당 페이지를 찾을 수 없습니다."));var U=()=>r.a.createElement(D,null);const M=({title:e})=>r.a.createElement("p",{className:"recipeTitle"},e);var P=r.a.memo(M);const A=({user:e,created:t})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"recipeWriter"},e)," ",r.a.createElement("span",{className:"recipeWriteDate"},t.substr(0,10)),r.a.createElement("hr",{className:"recipeWriteLine"}));var T=r.a.memo(A);const W=({image:e})=>r.a.createElement("section",null,r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"displayImage",className:"recipeImageLabel"},"이미지"),r.a.createElement("img",{id:"displayImage",src:e||"https://davidyang2149.github.io/MyBakingRecipeVol2/static/css/assets/images/cookie.jpeg",width:"200px",height:"200px",alt:"recipe"})));var q=r.a.memo(W);const z={0:"선택",1:"쿠키",2:"구움과자",3:"케이크",4:"빵",5:"마카롱",6:"기타"},G=({title:e,category:t,product:a,onChange:n})=>r.a.createElement("section",null,n?r.a.createElement("label",{htmlFor:"title",className:"recipeDutyLabel"},"레시피명"):r.a.createElement("label",{htmlFor:"title",className:"recipeLabel"},"레시피명"),r.a.createElement("input",{type:"text",id:"title",name:"title",className:"recipeInput",value:e,onChange:n,disabled:!n}),n?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"category",className:"recipeDutyLabel"},"카테고리"),r.a.createElement("label",{htmlFor:"product",className:"recipeDutyLabel"},"생산량")):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"category",className:"recipeLabel"},"카테고리"),r.a.createElement("label",{htmlFor:"product",className:"recipeLabel"},"생산량")),r.a.createElement("div",null,r.a.createElement("select",{id:"category",name:"category",className:"recipeSelect",value:t,onChange:n,disabled:!n},Object.entries(z).map(([e,t])=>r.a.createElement("option",{key:e,value:e},t))),r.a.createElement("input",{type:"number",min:"0",max:"1000000000",id:"product",name:"product",className:"recipeInput",value:a,onChange:n,disabled:!n}),r.a.createElement("span",{className:"recipeCount"},"개")));var H=r.a.memo(G);const Q=({description:e,onChange:t})=>r.a.createElement("section",null,r.a.createElement("label",{htmlFor:"description",className:t?"recipeDutyDescription":"recipeDescription"},"만드는 방법"),r.a.createElement("textarea",{id:"description",name:"description",className:"recipeTextarea",value:e,onChange:t,disabled:!t}));var V=r.a.memo(Q),J=a(35);function K(){return(K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const Y=({id:e,ingredient:t,weight:a,onChangeIngredient:n,onRemoveIngredient:c,provided:i})=>i?r.a.createElement("li",K({ref:i.innerRef},i.dragHandleProps,i.draggableProps),r.a.createElement("span",{className:"hamburger"}),r.a.createElement("input",{type:"text",id:"ingredient-"+e,name:"ingredient-"+e,className:"ingredientInput",value:t,onChange:n,width:"24%"}),r.a.createElement("input",{type:"number",min:"0",max:"1000000000",id:"weight-"+e,name:"weight-"+e,className:"ingredientInput",value:a,onChange:n,width:"13%"}),r.a.createElement("span",{className:"ingredientCount"},"g"),r.a.createElement("button",{type:"button",className:"ingredientDeleteButton",onClick:c,value:e},"삭제")):r.a.createElement("li",null,r.a.createElement("input",{type:"text",id:"ingredient-"+e,name:"ingredient-"+e,className:"ingredientInput",value:t,disabled:!0}),r.a.createElement("input",{type:"number",min:"0",max:"1000000000",id:"weight-"+e,name:"weight-"+e,className:"ingredientInput",value:a,onChange:n,disabled:!0}),r.a.createElement("span",{className:"ingredientCount"},"g"));var $=r.a.memo(Y);function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const Z=({ingredients:e,onChangeIngredient:t,onRemoveIngredient:a,onDragEndIngredient:n})=>n?r.a.createElement("section",null,r.a.createElement(J.a,{onDragEnd:n},r.a.createElement(J.c,{droppableId:"ingredients"},n=>r.a.createElement("ul",X({className:"ingredients",ref:n.innerRef},n.droppableProps),e.map(({id:e,ingredient:n,weight:c},i)=>r.a.createElement(J.b,{key:e.toString(),draggableId:e.toString(),index:i},i=>r.a.createElement($,{key:e,id:e,ingredient:n,weight:c,onChangeIngredient:t,onRemoveIngredient:a,provided:i}))),n.placeholder)))):r.a.createElement("section",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("label",{className:"ingredientName"},"원재료"),r.a.createElement("label",{className:"ingredientName"},"용량")),e.map(({id:e,ingredient:n,weight:c})=>r.a.createElement($,{key:e,id:e,ingredient:n,weight:c,onChangeIngredient:t,onRemoveIngredient:a}))));var _=r.a.memo(Z);var ee=()=>{Object(l.c)();const e=Object(o.f)(),[t,a]=Object(n.useState)(!1),{user:c,recipe:i}=Object(l.d)(e=>({user:e.user,recipe:e.recipe})),{id:d,userId:u,title:p,category:g,product:E,ingredients:b,description:v,image:h,created:y}=i,I=Object(n.useCallback)(()=>{window.confirm("레시피를 삭제하시겠습니까?")&&(a(!0),e.push("/"))},[e]);return d?r.a.createElement("article",null,r.a.createElement(P,{title:p}),r.a.createElement(T,{user:u,created:y||""}),r.a.createElement(q,{image:h||""}),r.a.createElement(H,{title:p,category:g,product:E}),r.a.createElement(_,{ingredients:b}),r.a.createElement(V,{description:v}),!!u&&u===c.userId&&r.a.createElement("section",null,r.a.createElement(s.b,{to:"/recipewrite/"+d},r.a.createElement("button",{type:"button",className:"button"},"수정하기")),r.a.createElement("button",{type:"button",className:"button",onClick:I,disabled:t},"삭제하기")),t&&r.a.createElement(m,null)):r.a.createElement(m,null)};const te=async e=>{const t=N.collection("recipes");let a;var n;return a=u(e)?await t.orderBy("created","desc").limit(12).get():await t.orderBy("created","desc").startAfter((n=(null==e?void 0:e.created)||"",I.Timestamp.fromDate(new Date(n)))).limit(12).get(),a.docs},ae={id:"",userId:"",title:"",category:0,product:0,ingredients:[],newIngredient:{id:0,ingredient:"",weight:0},description:"",upload:null,image:null,show:!1,created:"",updated:""},{actions:ne,reducer:re}=Object(b.b)({name:"recipe",initialState:ae,reducers:{setRecipe:(e,{payload:t})=>({...e,...t,newIngredient:{id:t.ingredients.length+1,ingredient:"",weight:0}}),clearRecipe:e=>({...e,...ae})}}),ce=e=>async t=>{const a=await(async({id:e})=>{const t=N.collection("recipes");return await t.doc(e).get()})({id:e});a.exists?t(ne.setRecipe(g(a))):t(ne.setRecipe(ae))},{setRecipe:ie,clearRecipe:le}=ne;var se=re;var oe=()=>{const e=Object(l.c)(),{id:t}=Object(o.g)();return Object(n.useEffect)(()=>{e(le()),e(ce(t))},[e,t]),r.a.createElement(ee,null)};var me=({root:e=null,target:t,onIntersect:a,threshold:r=1,rootMargin:c="50px"})=>{Object(n.useEffect)(()=>{const n=new IntersectionObserver(a,{root:e,rootMargin:c,threshold:r});if(!u(t))return n.observe(t),()=>n.unobserve(t)},[t,e,c,a,r])};var de=({recipe:e})=>{const{id:t,image:a,title:n,description:c,created:i,userId:l}=e,o=d+"assets/images/cookie.jpeg";return r.a.createElement("li",{className:"recipeItem"},r.a.createElement(s.b,{to:"/recipe/"+t},r.a.createElement("figure",{className:"card-image",style:{backgroundImage:`url(${a||o})`}},r.a.createElement("img",{src:a||o,alt:"recipe"})),r.a.createElement("div",{className:"card-desc"},r.a.createElement("h1",null,n),r.a.createElement("p",null,c.length>30?c.substring(0,30)+"...":c),r.a.createElement("p",{className:"card-created"},null==i?void 0:i.substr(0,10)),r.a.createElement("p",null,"by"," ",r.a.createElement("strong",null,l.split("@")[0])))))};const ue=({recipesBook:e})=>u(e.length)?r.a.createElement("div",null,"Empty"):r.a.createElement("ul",{className:"recipeList"},e.map(e=>r.a.createElement(de,{key:e.id,recipe:e})));var pe=r.a.memo(ue);var ge=()=>{const{recipes:e}=Object(l.d)(e=>({recipes:e.recipes})),{recipesBook:t}=e;return u(t.length)?r.a.createElement(m,null):r.a.createElement("article",null,r.a.createElement(pe,{recipesBook:t}))};const{actions:Ee,reducer:be}=Object(b.b)({name:"recipes",initialState:{recipesBook:[],lastRecipe:{recipe:null,isLast:!1}},reducers:{setRecipes:(e,{payload:t})=>({...e,recipesBook:[...t]}),setLastRecipe:(e,{payload:{name:t,value:a}})=>({...e,lastRecipe:{...e.lastRecipe,[t]:a}}),addRecipes:(e,{payload:t})=>({...e,recipesBook:[...e.recipesBook,...t]})}}),{setRecipes:ve,setLastRecipe:he,addRecipes:ye}=Ee;var Ie=be;var Ne=()=>{const e=Object(l.c)(),[t,a]=Object(n.useState)(null);return me({target:t,onIntersect:([{isIntersecting:t}])=>{t&&e(async(e,t)=>{const{recipes:{lastRecipe:{recipe:a,isLast:n}}}=t();if(n)return;const r=await te(a);if(u(r))return void e(Ee.setRecipes([]));const c=r.map(e=>g(e)),i=c.length<12;e(Ee.addRecipes(c)),e(Ee.setLastRecipe({name:"recipe",value:c.splice(-1)[0]})),e(Ee.setLastRecipe({name:"isLast",value:i}))})}}),r.a.createElement(r.a.Fragment,null,r.a.createElement(ge,null),r.a.createElement("div",{ref:a}))};var we=()=>{const e=Object(l.c)();return Object(n.useEffect)(()=>{e(B())},[e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(n.Suspense,{fallback:r.a.createElement(m,null)},r.a.createElement(x,null),r.a.createElement("div",{className:"main"},r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:"/",component:Ne}),r.a.createElement(o.a,{path:"/recipe/:id",component:oe}),r.a.createElement(o.a,{component:U})))))},fe=a(16);var Re=Object(fe.c)({user:F,recipe:se,recipes:Ie});var ke=Object(b.a)({reducer:Re});i.a.render(r.a.createElement(l.a,{store:ke},r.a.createElement(s.a,{basename:"/MyBakingRecipeVol2"},r.a.createElement(we,null))),document.getElementById("app"))}},[[60,1,4,12,9,8,13,11,6,14,10,16,7,15,2,3,5]]]);