(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{60:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(25),c=a.n(i),l=a(8),s=a(19),o=a(6);var m=()=>r.a.createElement("div",{className:"div-modal"},r.a.createElement("div",{className:"div-loading-animation"}));const d="https://davidyang2149.github.io/MyBakingRecipeVol2/static/css/",p=e=>!e,u=e=>e.toDate().toISOString(),g=e=>{const{created:t,updated:a}=e.data(),{userId:n,title:r,product:i,category:c,newIngredient:l,ingredients:s,description:o,upload:m,image:d,show:p}=e.data();return{id:e.id,userId:n,title:r,product:i,category:c,newIngredient:l,ingredients:s,description:o,upload:m,image:d,show:p,created:u(t),updated:u(a)}};var E=({userId:e,onSignIn:t,onSignOut:a})=>{return r.a.createElement("nav",{className:"nav-header"},r.a.createElement("div",null,r.a.createElement(s.b,{to:"/"},r.a.createElement("img",{className:"img-home",src:d+"assets/images/home.svg",alt:"Home"})),r.a.createElement(s.b,{to:"/"},r.a.createElement("h1",{className:"h1-home"},"My Baking Recipe"))),e?r.a.createElement("div",{className:"div-user-info"},r.a.createElement("p",{className:"p-user-name"},r.a.createElement(s.b,{to:"/"},(n=e,e=>n.split(e)[0])("@"))),r.a.createElement("button",{className:"button-header",type:"button"},"New Recipe"),r.a.createElement("button",{className:"button-header",type:"button",onClick:a},"Logout"),r.a.createElement("img",{className:"img-user-icon",src:d+"assets/images/new-recipe.svg",alt:"New Recipe"}),r.a.createElement("img",{className:"img-user-icon",src:d+"assets/images/close-outline.svg",onClick:a,alt:"Logout"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"button-header",type:"button",onClick:t},"Sign in (Google)"),r.a.createElement("img",{className:"img-user-icon",src:d+"assets/images/login-google.svg",onClick:t,alt:"singIn"})));var n},b=a(21),v=a(24);a(53),a(55),a(58);var h={apiKey:"AIzaSyBWq2ijQg3f9QqIx3gDKsYda0wIeed5zqE",authDomain:"mybakingrecipe.firebaseapp.com",databaseURL:"https://mybakingrecipe-default-rtdb.firebaseio.com",projectId:"mybakingrecipe",storageBucket:"mybakingrecipe.appspot.com",messagingSenderId:"915152243690",appId:"1:915152243690:web:eabd6afc6124e887434093",measurementId:"G-R8B8QCRYLB",status:"production"};v.a.initializeApp(h);const y=v.a.auth(),w=v.a.firestore,N=v.a.firestore(),I=new v.a.auth.GoogleAuthProvider,k=(v.a.storage(),(e,t)=>{sessionStorage.setItem(e,t)}),f={userId:"",displayName:""},{actions:R,reducer:O}=Object(b.b)({name:"user",initialState:f,reducers:{setUser:(e,{payload:{name:t,value:a}})=>({...e,[t]:a}),clearUser:e=>({...e,...f})}}),j=()=>async e=>{try{const{user:t}=await(async()=>await y.signInWithPopup(I))(),a=(null==t?void 0:t.email)||"";k("user",a),e(R.setUser({name:"userId",value:a}))}catch(e){throw new Error(e.message)}},C=()=>async e=>{var t;await(async()=>{await y.signOut()})(),t="user",sessionStorage.removeItem(t),e(R.clearUser())},S=()=>e=>{setTimeout(()=>{const t=y.currentUser,a=(null==t?void 0:t.email)||(n="user",sessionStorage.getItem(n))||"";var n;p(a)?e(R.clearUser()):(k("user",a),e(R.setUser({name:"userId",value:a})))},500)},{setUser:B,clearUser:x}=R;var L=O;var U=()=>{const e=Object(l.c)(),{user:{userId:t}}=Object(l.d)(e=>({user:e.user}));return r.a.createElement(E,{userId:t,onSignIn:()=>{e(j())},onSignOut:()=>{e(C())}})};var F=()=>r.a.createElement("div",{className:"div-not-found-modal"},r.a.createElement("img",{className:"img-not-found-image",src:d+"assets/images/page-not-found.svg",alt:"recipe"}),r.a.createElement("p",{className:"p-not-found-title"},"해당 페이지를 찾을 수 없습니다."));var D=()=>r.a.createElement(F,null);const P=({title:e})=>r.a.createElement("p",{className:"p-recipe-title"},e);var M=r.a.memo(P);const A=({user:e,created:t})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"span-recipe-writer"},e)," ",r.a.createElement("span",{className:"span-recipe-write-date"},t.substr(0,10)),r.a.createElement("hr",{className:"hr-recipe-write-line"}));var q=r.a.memo(A);const z=({image:e})=>r.a.createElement("section",null,r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"displayImage",className:"label-recipe-image"},"이미지"),r.a.createElement("img",{id:"displayImage",className:"img-recipe-image",src:e||"https://davidyang2149.github.io/MyBakingRecipeVol2/static/css/assets/images/cookie.jpeg",width:"200px",height:"200px",alt:"recipe"})));var G=r.a.memo(z);const Q={0:"선택",1:"쿠키",2:"구움과자",3:"케이크",4:"빵",5:"마카롱",6:"기타"},V=({title:e,category:t,product:a,onChange:n})=>r.a.createElement("section",null,r.a.createElement("label",{htmlFor:"title",className:(n?"duty":"")+" label-recipe block"},"레시피명"),r.a.createElement("input",{type:"text",id:"title",name:"title",className:"input-recipe block width-60",value:e,onChange:n,disabled:!n}),r.a.createElement("label",{htmlFor:"category",className:(n?"duty":"")+" label-recipe inline-block width-30"},"카테고리"),r.a.createElement("label",{htmlFor:"product",className:(n?"duty":"")+" label-recipe inline-block width-20"},"생산량"),r.a.createElement("div",null,r.a.createElement("select",{id:"category",name:"category",className:"select-recipe width-30",value:t,onChange:n,disabled:!n},Object.entries(Q).map(([e,t])=>r.a.createElement("option",{key:e,value:e},t))),r.a.createElement("input",{type:"number",min:"0",max:"1000000000",id:"product",name:"product",className:"input-recipe inline-block width-20",value:a,onChange:n,disabled:!n}),r.a.createElement("span",{className:"span-recipe-count inline-block"},"개")));var H=r.a.memo(V);const J=({description:e,onChange:t})=>r.a.createElement("section",null,r.a.createElement("label",{htmlFor:"description",className:(t?"duty":"")+" label-recipe-description block"},"만드는 방법"),r.a.createElement("textarea",{id:"description",name:"description",className:"textarea-recipe",value:e,onChange:t,disabled:!t}));var K=r.a.memo(J),T=a(35);function W(){return(W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const Y=({id:e,ingredient:t,weight:a,onChangeIngredient:n,onRemoveIngredient:i,provided:c})=>c?r.a.createElement("li",W({ref:c.innerRef},c.dragHandleProps,c.draggableProps),r.a.createElement("span",{className:"span-hamburger"}),r.a.createElement("input",{type:"text",id:"ingredient-"+e,name:"ingredient-"+e,className:"input-ingredient width-24",value:t,onChange:n}),r.a.createElement("input",{type:"number",min:"0",max:"1000000000",id:"weight-"+e,name:"weight-"+e,className:"input-ingredient width-13",value:a,onChange:n}),r.a.createElement("span",{className:"span-ingredient-count"},"g"),r.a.createElement("button",{type:"button",className:"button-ingredient-delete",onClick:i,value:e},"삭제")):r.a.createElement("li",null,r.a.createElement("input",{type:"text",id:"ingredient-"+e,name:"ingredient-"+e,className:"input-ingredient width-30",value:t,disabled:!0}),r.a.createElement("input",{type:"number",min:"0",max:"1000000000",id:"weight-"+e,name:"weight-"+e,className:"input-ingredient width-20",value:a,onChange:n,disabled:!0}),r.a.createElement("span",{className:"span-ingredient-count"},"g"));var $=r.a.memo(Y);function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const Z=({ingredients:e,onChangeIngredient:t,onRemoveIngredient:a,onDragEndIngredient:n})=>n?r.a.createElement("section",null,r.a.createElement(T.a,{onDragEnd:n},r.a.createElement(T.c,{droppableId:"ingredients"},n=>r.a.createElement("ul",X({className:"ingredients",ref:n.innerRef},n.droppableProps),e.map(({id:e,ingredient:n,weight:i},c)=>r.a.createElement(T.b,{key:e.toString(),draggableId:e.toString(),index:c},c=>r.a.createElement($,{key:e,id:e,ingredient:n,weight:i,onChangeIngredient:t,onRemoveIngredient:a,provided:c}))),n.placeholder)))):r.a.createElement("section",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("label",{className:"label-ingredient-name inline-block width-32"},"원재료"),r.a.createElement("label",{className:"label-ingredient-name inline-block width-20"},"용량")),e.map(({id:e,ingredient:n,weight:i})=>r.a.createElement($,{key:e,id:e,ingredient:n,weight:i,onChangeIngredient:t,onRemoveIngredient:a}))));var _=r.a.memo(Z);var ee=()=>{Object(l.c)();const e=Object(o.f)(),[t,a]=Object(n.useState)(!1),{user:i,recipe:c}=Object(l.d)(e=>({user:e.user,recipe:e.recipe})),{id:d,userId:p,title:u,category:g,product:E,ingredients:b,description:v,image:h,created:y}=c,w=Object(n.useCallback)(()=>{window.confirm("레시피를 삭제하시겠습니까?")&&(a(!0),e.push("/"))},[e]);return d?r.a.createElement("article",null,r.a.createElement(M,{title:u}),r.a.createElement(q,{user:p,created:y||""}),r.a.createElement(G,{image:h||""}),r.a.createElement(H,{title:u,category:g,product:E}),r.a.createElement(_,{ingredients:b}),r.a.createElement(K,{description:v}),!!p&&p===i.userId&&r.a.createElement("section",null,r.a.createElement(s.b,{to:"/recipewrite/"+d},r.a.createElement("button",{type:"button",className:"button-recipe-owner"},"수정하기")),r.a.createElement("button",{type:"button",className:"button-recipe-owner",onClick:w,disabled:t},"삭제하기")),t&&r.a.createElement(m,null)):r.a.createElement(m,null)};const te=async e=>{const t=N.collection("recipes");let a;var n;return a=p(e)?await t.orderBy("created","desc").limit(12).get():await t.orderBy("created","desc").startAfter((n=(null==e?void 0:e.created)||"",w.Timestamp.fromDate(new Date(n)))).limit(12).get(),a.docs},ae={id:"",userId:"",title:"",category:0,product:0,ingredients:[],newIngredient:{id:0,ingredient:"",weight:0},description:"",upload:null,image:null,show:!1,created:"",updated:""},{actions:ne,reducer:re}=Object(b.b)({name:"recipe",initialState:ae,reducers:{setRecipe:(e,{payload:t})=>({...e,...t,newIngredient:{id:t.ingredients.length+1,ingredient:"",weight:0}}),clearRecipe:e=>({...e,...ae})}}),ie=e=>async t=>{const a=await(async({id:e})=>{const t=N.collection("recipes");return await t.doc(e).get()})({id:e});a.exists?t(ne.setRecipe(g(a))):t(ne.setRecipe(ae))},{setRecipe:ce,clearRecipe:le}=ne;var se=re;var oe=()=>{const e=Object(l.c)(),{id:t}=Object(o.g)();return Object(n.useEffect)(()=>{e(le()),e(ie(t))},[e,t]),r.a.createElement(ee,null)};var me=({root:e=null,target:t,onIntersect:a,threshold:r=1,rootMargin:i="50px"})=>{Object(n.useEffect)(()=>{const n=new IntersectionObserver(a,{root:e,rootMargin:i,threshold:r});if(!p(t))return n.observe(t),()=>n.unobserve(t)},[t,e,i,a,r])};var de=({recipe:e})=>{const{id:t,image:a,title:n,description:i,created:c,userId:l}=e,o=d+"assets/images/cookie.jpeg";return r.a.createElement("li",{className:"li-recipe-item"},r.a.createElement(s.b,{to:"/recipe/"+t},r.a.createElement("figure",{className:"figure-card-image",style:{backgroundImage:`url(${a||o})`}},r.a.createElement("img",{src:a||o,alt:"recipe"})),r.a.createElement("div",{className:"div-card-description"},r.a.createElement("h1",null,n),r.a.createElement("p",null,i.length>30?i.substring(0,30)+"...":i),r.a.createElement("p",{className:"p-card-created"},null==c?void 0:c.substr(0,10)),r.a.createElement("p",null,"by"," ",r.a.createElement("strong",null,l.split("@")[0])))))};const pe=({recipesBook:e})=>p(e.length)?r.a.createElement("div",null,"Empty"):r.a.createElement("ul",{className:"ul-recipe-list"},e.map(e=>r.a.createElement(de,{key:e.id,recipe:e})));var ue=r.a.memo(pe);var ge=()=>{const{recipes:e}=Object(l.d)(e=>({recipes:e.recipes})),{recipesBook:t}=e;return p(t.length)?r.a.createElement(m,null):r.a.createElement("article",null,r.a.createElement(ue,{recipesBook:t}))};const{actions:Ee,reducer:be}=Object(b.b)({name:"recipes",initialState:{recipesBook:[],lastRecipe:{recipe:null,isLast:!1}},reducers:{setRecipes:(e,{payload:t})=>({...e,recipesBook:[...t]}),setLastRecipe:(e,{payload:{name:t,value:a}})=>({...e,lastRecipe:{...e.lastRecipe,[t]:a}}),addRecipes:(e,{payload:t})=>({...e,recipesBook:[...e.recipesBook,...t]})}}),{setRecipes:ve,setLastRecipe:he,addRecipes:ye}=Ee;var we=be;var Ne=()=>{const e=Object(l.c)(),[t,a]=Object(n.useState)(null);return me({target:t,onIntersect:([{isIntersecting:t}])=>{t&&e(async(e,t)=>{const{recipes:{lastRecipe:{recipe:a,isLast:n}}}=t();if(n)return;const r=await te(a);if(p(r))return void e(Ee.setRecipes([]));const i=r.map(e=>g(e)),c=i.length<12;e(Ee.addRecipes(i)),e(Ee.setLastRecipe({name:"recipe",value:i.splice(-1)[0]})),e(Ee.setLastRecipe({name:"isLast",value:c}))})}}),r.a.createElement(r.a.Fragment,null,r.a.createElement(ge,null),r.a.createElement("div",{ref:a}))};var Ie=()=>{const e=Object(l.c)();return Object(n.useEffect)(()=>{e(S())},[e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(n.Suspense,{fallback:r.a.createElement(m,null)},r.a.createElement(U,null),r.a.createElement("div",{className:"div-main"},r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:"/",component:Ne}),r.a.createElement(o.a,{path:"/recipe/:id",component:oe}),r.a.createElement(o.a,{component:D})))))},ke=a(16);var fe=Object(ke.c)({user:L,recipe:se,recipes:we});var Re=Object(b.a)({reducer:fe});c.a.render(r.a.createElement(l.a,{store:Re},r.a.createElement(s.a,{basename:"/MyBakingRecipeVol2"},r.a.createElement(Ie,null))),document.getElementById("app"))}},[[60,1,4,12,9,8,13,11,6,14,10,16,7,15,2,3,5]]]);